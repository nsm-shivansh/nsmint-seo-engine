<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="meta-title">N S Mint Products</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
        .dropdown:hover .dropdown-menu { display: block; }
        .hero-gradient { background: linear-gradient(135deg, #064e3b 0%, #059669 100%); }
    </style>
</head>
<body class="bg-white text-slate-900">

    <nav class="bg-white border-b border-slate-100 sticky top-0 z-[100]">
        <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
            <img src="https://www.nsmint.com/images/logo.png" alt="N S Mint Logo" class="h-16">
            <div class="text-right">
                <span class="block text-[10px] font-black uppercase tracking-widest text-slate-400">3-Star Export House</span>
                <span class="text-green-700 font-bold">Sambhal, India</span>
            </div>
        </div>
        <div class="bg-slate-900 text-white w-full overflow-visible">
            <div id="category-nav" class="max-w-7xl mx-auto px-6 flex justify-start items-center overflow-x-auto whitespace-nowrap min-h-[60px] space-x-4">
                <span class="text-[10px] font-bold text-slate-500 uppercase">Categories:</span>
                </div>
        </div>
    </nav>

    <header class="hero-gradient text-white py-28 px-6">
        <div class="max-w-6xl mx-auto">
            <h1 id="main-heading" class="text-5xl md:text-8xl font-black mb-6 tracking-tighter leading-none">
                </h1>
            <p class="text-xl md:text-3xl font-light opacity-90 max-w-4xl">
                Premium factory-direct supply for manufacturing units in <span class="country-display font-bold text-green-300"></span>.
            </p>
        </div>
    </header>

    <main class="max-w-7xl mx-auto py-20 px-6 grid lg:grid-cols-3 gap-12">
        <div class="lg:col-span-2 space-y-12">
            
            <section class="bg-white border-4 border-slate-100 rounded-[3rem] p-12 shadow-xl">
                <h2 class="text-sm font-black text-slate-400 uppercase tracking-widest mb-10">Technical Specifications</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="border-b-2 border-slate-50 pb-4">
                        <p class="text-xs font-bold text-green-600 uppercase mb-1">Standard Grade</p>
                        <p id="spec-grade" class="text-3xl font-black text-slate-800">...</p>
                    </div>
                    <div class="border-b-2 border-slate-50 pb-4">
                        <p class="text-xs font-bold text-green-600 uppercase mb-1">Chemical Purity</p>
                        <p id="spec-purity" class="text-3xl font-black text-slate-800">...</p>
                    </div>
                    <div class="border-b-2 border-slate-50 pb-4">
                        <p class="text-xs font-bold text-green-600 uppercase mb-1">Method</p>
                        <p id="spec-method" class="text-3xl font-black text-slate-800">...</p>
                    </div>
                    <div class="border-b-2 border-slate-50 pb-4">
                        <p class="text-xs font-bold text-green-600 uppercase mb-1">Origin</p>
                        <p class="text-3xl font-black text-slate-800">Sambhal, India</p>
                    </div>
                </div>
            </section>

            <div class="prose prose-xl max-w-none text-slate-600">
                <h2 class="text-4xl font-extrabold text-slate-900 mb-6">Exporter to <span class="country-display"></span></h2>
                <p id="p1" class="leading-relaxed"></p>
                <div class="my-10 p-8 bg-slate-50 rounded-2xl border border-slate-200">
                    <p class="text-sm font-bold uppercase text-slate-400 mb-4 tracking-widest">Industry Compliance</p>
                    <p class="text-xl font-medium text-slate-800">Our products are WHO-GMP, REACH, and FSSC 22000 certified for the pharmaceutical and fragrance industries.</p>
                </div>
                <p id="p2" class="leading-relaxed"></p>
            </div>
        </div>

        <aside class="lg:col-span-1">
            <div class="sticky top-40 bg-green-700 text-white p-10 rounded-[2.5rem] shadow-2xl">
                <h3 class="text-3xl font-black mb-6">Inquire for <span class="country-display"></span></h3>
                <p class="mb-8 opacity-80">Get the latest batch price and Certificates of Analysis (COA).</p>
                <a href="mailto:sales@nsmint.com" id="email-link" class="block w-full text-center bg-white text-green-800 font-bold py-5 rounded-2xl hover:bg-slate-100 transition shadow-lg">Request Factory Price</a>
            </div>
        </aside>
    </main>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const ctry = urlParams.get('country') || 'Libya';
        const prod = urlParams.get('product') || 'L-Menthol Crystals IP';
        
        // Added cache buster (&cb=...) to ensure fresh data
        const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTin-HV31mE-Bj1ksOeaiFwvBKQbc7MLpk1XiYm69v63yhualNST3yEDCZ-CWtoN0-9IZlzqu7zoR1e/pub?output=csv' + '&cb=' + new Date().getTime();

        async function init() {
            // Fix text immediately
            document.getElementById('main-heading').innerText = prod + ' Supply to ' + ctry;
            document.querySelectorAll('.country-display').forEach(el => el.innerText = ctry);
            document.getElementById('email-link').href = `mailto:sales@nsmint.com?subject=Inquiry: ${prod} for ${ctry}`;

            try {
                const res = await fetch(sheetUrl);
                const csvText = await res.text();
                const lines = csvText.split(/\r?\n/).slice(1); // Remove header
                
                const menuSilos = {};

                for (let line of lines) {
                    const parts = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                    if (parts.length < 5) continue;

                    // HARD-CODED COLUMN LOGIC:
                    const row_category = parts[0].replace(/"/g, '').trim();
                    const row_product  = parts[1].replace(/"/g, '').trim();
                    const row_country  = parts[2].replace(/"/g, '').trim();
                    const row_purity   = parts[3].replace(/"/g, '').trim();
                    const row_grade    = parts[4].replace(/"/g, '').trim();
                    const row_method   = parts[5].replace(/"/g, '').trim();

                    // Only handle links for the current country
                    if (row_country.toLowerCase() === ctry.toLowerCase()) {
                        if (!menuSilos[row_category]) menuSilos[row_category] = [];
                        if (!menuSilos[row_category].includes(row_product)) menuSilos[row_category].push(row_product);

                        // If this is our product, fill the specs
                        if (row_product.toLowerCase() === prod.toLowerCase()) {
                            document.getElementById('spec-purity').innerText = row_purity;
                            document.getElementById('spec-grade').innerText = row_grade;
                            document.getElementById('spec-method').innerText = row_method;
                        }
                    }
                }

                // Render Menus
                const nav = document.getElementById('category-nav');
                Object.keys(menuSilos).forEach(category => {
                    const wrap = document.createElement('div');
                    wrap.className = "dropdown relative group";
                    wrap.innerHTML = `
                        <button class="text-[11px] font-black uppercase text-slate-300 group-hover:text-green-400 py-5 px-3">
                            ${category} â–¾
                        </button>
                        <div class="dropdown-menu absolute hidden left-0 bg-white text-slate-900 shadow-2xl rounded-xl p-3 min-w-[260px] border border-slate-100 top-full z-[100]">
                            ${menuSilos[category].map(pName => `
                                <a href="page.html?product=${encodeURIComponent(pName)}&country=${encodeURIComponent(ctry)}" 
                                   class="block text-[12px] font-bold py-2 px-4 hover:bg-green-50 hover:text-green-800 rounded-lg transition">
                                   ${pName}
                                </a>
                            `).join('')}
                        </div>`;
                    nav.appendChild(wrap);
                });

                document.getElementById('p1').innerText = `As a 3-Star Export House, N S Mint Products specializes in the manufacturing of ${prod} for the ${ctry} market. Our Sambhal factory ensures purity meets international pharma standards.`;
                document.getElementById('p2').innerText = `We manage global logistics for ${prod} shipments to ${ctry}, providing all COA and REACH documentation for your industrial requirements.`;

            } catch (e) { console.error(e); }
        }
        init();
    </script>
</body>
</html>
